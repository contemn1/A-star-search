
\documentclass[12pt]{amsart}
\usepackage{listings}
\usepackage{color}
\usepackage{graphicx}
\usepackage{palatino}
\usepackage{tikz}
\usepackage{amssymb}
\usepackage{cite}
\usepackage[colorlinks,linkcolor=red]{hyperref}
\usetikzlibrary{shapes.geometric, arrows}
\usepackage{blkarray}
\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}

\lstset{frame=tb,
  language=Python,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  numbers=none,
  numberstyle=\tiny\color{gray},
  keywordstyle=\color{blue},
  commentstyle=\color{dkgreen},
  stringstyle=\color{mauve},
  breaklines=true,
  breakatwhitespace=true,
  tabsize=3
}
\title{NLP_HW4}
\author{Xuan Wang}
\date{} % delete this line to display the current date

%%% BEGIN DOCUMENT

\begin{document}


\begin{titlepage}

\begin{center}


% Upper part of the page

\textsc{\LARGE University of Rutgers}\\[1.5cm]

\textsc{\Large Assignment 4}\\[0.5cm]


% Author and supervisor
\begin{minipage}{0.4\textwidth}
\begin{flushleft} \large
\emph{Author:}\\
Xuan \textsc{Wang}

Xunjie \textsc{Zhu}
\end{flushleft}
\end{minipage}
\begin{minipage}{0.4\textwidth}
\begin{flushright} \large
\emph{Supervisor:} \\
Abdeslam  \textsc{Boularias}
\end{flushright}
\end{minipage}

\vfill

% Bottom of the page
{\large \today}

\end{center}

\end{titlepage}

\section*{Problem 1}
\subsection*{Filtering}
The state transition matrix of the problem is
\[
\begin{bmatrix}
    0.5       & 0.5 & 0 &0 & 0 & 0 \\
    0       & 0 & 0.5 &0.5& 0 & 0 \\
    0       & 0 & 0 &0.5 & 0.5 & 0 \\
    0       & 0 & 0 &0 & 0.5 & 0.5 \\
    0       & 0 & 0 &0 & 0 & 0.5 \\
\end{bmatrix}
\]
The emission matrix of the problem is:
\[
\begin{bmatrix}
    0   & 1  \\
    1   & 0  \\
    1   & 0  \\
    0   & 1  \\
    1   & 0  \\
    1   & 0  \\
\end{bmatrix}
\]
The probability distribution of the initial state is 
\[
\begin{bmatrix}
    1       & 0 & 0 &0 & 0 & 0 \\
\end{bmatrix}
\]
For any state variable $x_i$, 
\begin{equation} \label{eq1}
\begin{split}
P(x_t | e_{1:t})    & = \frac{P(x_t , e_{1:t})}{P(e_{1:t})} \\
 			  & = \frac{P(e_t | x_t) \sum_{x_{t-1}}{P(x_t|x_{t-1}) P(x_{t-1} , e_{1:t-1})}}{P(e_{1:t})} \\
\end{split}
\end{equation}
when t=1
\begin{align*}
P(A|hot)  &= 1 \\
P(B|hot) &= 0 \\
P(C|hot) &= 0 \\
P(D|hot) &= 0 \\
P(E|hot) &= 0 \\
P(F|hot) &= 0 \\
\end{align*}

when t=2

\begin{align*}
P(A|hot, cold) &= \frac{P(cold | A) \sum_{x_{t-1}}{P(x_2|x_1) P(x_1, hot)}}{P(cold, hot)} = 0\\
P(D|hot, cold) &= \frac{P(cold | D) \sum_{x_{t-1}}{P(x_2|x_1) P(x_1, hot)}}{P(cold, hot)} = 0\\
P(C|hot, cold) &= \frac{P(cold | C) \sum_{x_{t-1}}{P(x_2|x_1) P(x_1, hot)}}{P(cold, hot)} = 0\\
P(E|hot, cold) &= \frac{P(cold | E) \sum_{x_{t-1}}{P(x_2|x_1) P(x_1, hot)}}{P(cold, hot)} = 0\\
P(F|hot, cold) &=\frac{P(cold | F) \sum_{x_{t-1}}{P(x_2|x_1) P(x_1, hot)}}{P(cold, hot)} = 0\\
P(B|hot, cold) &= \frac{P(cold | B) \sum_{x_{t-1}}{P(x_2|x_1) P(x_1, hot)}}{P(cold, hot)} = 1\\
\end{align*}

when t=3
\begin{align*}
P(A|hot, cold, cold) &= \frac{P(cold | A) \sum_{x_{t-1}}{P(x_3|x_2) P(x_2, cold, hot)}}{P(cold, cold, hot)} = 0\\
P(B|hot, cold, cold) &= \frac{P(cold | B) \sum_{x_{t-1}}{P(x_3|x_2) P(x_2, cold, hot)}}{P(cold, cold, hot)} = \frac{1}{2}\\
P(C|hot, cold, cold) &= \frac{P(cold | C) \sum_{x_{t-1}}{P(x_3|x_2) P(x_2, cold, hot)}}{P(cold, cold, hot)} = \frac{1}{2}\\
P(D|hot, cold, cold) &= \frac{P(cold | D) \sum_{x_{t-1}}{P(x_3|x_2) P(x_2, cold, hot)}}{P(cold, cold, hot)} = 0\\
P(E|hot, cold, cold) &= \frac{P(cold | E) \sum_{x_{t-1}}{P(x_3|x_2) P(x_2, cold, hot)}}{P(cold, cold, hot)} = 0\\
P(F|hot, cold, cold) &= \frac{P(cold | F) \sum_{x_{t-1}}{P(x_3|x_2) P(x_2, cold, hot)}}{P(cold, cold, hot)} = 0\\
\end{align*}

The probability distribution of the over the rover's position on day 3 is \\
\[
\begin{bmatrix}
    0       & 0.5 & 0.5 &0 & 0 & 0 \\
\end{bmatrix}
\]

\subsection*{Smoothing}
\begin{equation} \label{eq 2}
\begin{split}
P(x_2|e_{1:t})    & = \frac{P(e_{k+1:t} , x_k) P(x_k| e_{1:k})}{\sum{x_k}{P(e{k+1:t}|x_k) P(x_k| e_{1:k})}} \\
\end{split}
\end{equation}

when k=2, t=3

\begin{equation} \label{eq3}
\begin{split}
P(x_2|e_{1:3})  & = \frac{P(e_3 , x_2) P(x_2| e_{1:2})}{\sum{x_k}{P(e3|x_2) P(x_2| e_{1:2})}} \\
\end{split}
\end{equation}
According to the formula above, the probability of each state x are given as follows:
\begin{align*}
P(A|hot, cold, cold) &= 0\\
P(B|hot, cold, cold) &= 1\\
P(D|hot, cold, cold) &= 0\\
P(C|hot, cold. cold) &= 0\\
P(E|hot, cold, cold) &= 0\\
P(F|hot, cold, cold) &= 0\\
\end{align*}

\subsection*{Most likely explanation}
\begin{align*}
P(X_1 | hot1, cold2, cold3) &= \{1, 0, 0, 0, 0, 0\} \\
P(X_2 | hot1, cold2, cold3) &= \{0, 1, 0, 0, 0, 0\} \\
P(X_3 | hot1, cold2, cold3) &= \{0, \frac{1}{2}, \frac{1}{2}, 0, 0, 0\}
\end{align*}
So the most likely sequence of the rover's position in the three days given the observations (E1=hot, E2=cold, E3= cold) is  (A, B, B) or (A, B, C)

\subsection*{Prediction}
\begin{align*}
P(E_{t+1:T} | E_{1:t}) &= \sum_{x_t} P(x_t| E_{1:t})P(E_{t+1:T}|x_t) \\
P(E_{t+1:T} | x_t) &= \sum_{x_{t+1}}{P(x_{t+1}| x_t)P(E_{t+1}|x_{t+1})P(E_{t+2:T}|x_{t+1})} \\
\end{align*}
when t=3, T=6, t4=hot, t5=hot, t6=cold 
\begin{align*}
P(A|hot, cold, cold) &= 0  \\
P(B|hot, cold, cold) &=0.5 \\
P(C|hot, cold, cold) &=0.5 \\
P(D|hot, cold, cold) &=0  \\
P(E|hot, cold, cold) &=0  \\
P(F|hot, cold, cold)  &= 0 \\
P(hot4, hot5, cold6 | hot1, cold2, cold3) &= 0.5 (P(hot4, hot5, cold6 | B) + P(hot4, hot5, hot6 | C)) \\
							     &= 0.5 (\sum_{x_3 \in B, C}\sum_{x_4} P(x_4| x_3)P(hot|x_4)P(hot, cold|x_{4})
\end{align*}

\begin{align*}
&\because   \sum_{x_4} P(x_4| B)P(hot|x_4)P(hot, cold|x_{4} = 0 \\
&\therefore  P(hot4, hot5, cold6 | hot1, cold2, cold3) = 0.5 \sum_{x_4} P(x_4| C)P(hot|x_4)P(hot, cold |x_{4}) \\
	& =0.5 \sum_{x_6}\sum_{x_5}\sum_{x_4} P(x_4| C)P(hot|x_4) P(x_5|x_4) P(hot|x_5) P(x_6|x_5) P(cold|x_6)\\
	&= \frac{1}{16}
\end{align*}

\subsection*{Prediction}
\begin{align*}
P(x_4 | hot_1, cold_2, cold_3) = \sum_{x_3}P(x_4| x_3) P(x_3 | hot_1, cold_2, cold_3)
\end{align*}
$P(X_4 | hot_1, cold_2, cold_3) = \{0, \frac{1}{4}, \frac{1}{2}, \frac{1}{4}, 0, 0  \}$
$P(X_5 | hot_1, cold_2, cold_3) = \{0, \frac{1}{8}, \frac{3}{8}, \frac{3}{8}, \frac{1}{8}, 0  \}$



\end{document}